openapi: 3.1.0
info:
  title: Government salary API
  version: 1.2.1

tags:
  - name: Country
  - name: World

paths:
  /data/{code}/{year}/data.json:
    get:
      tags: [Country]
      summary: Get data by country and year
      parameters:
        - name: code
          in: path
          required: true
          description: ISO country code (alpha-2).
          schema:
            type: string
            pattern: "^[A-Za-z]{2}$"
            example: us
        - name: year
          in: path
          required: true
          description: Calendar year of the data.
          schema:
            type: integer
            example: 2025
      responses:
        "200":
          description: OK
          headers:
            ETag:
              description: Entity tag for caching.
              schema: { type: string }
            Cache-Control:
              description: Cache hints from CDN.
              schema: { type: string }
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CountryData"
        "404":
          description: Not Found

  /data/{code}/{year}/rates.json:
    get:
      tags: [Country]
      summary: Get rates by country and year
      parameters:
        - name: code
          in: path
          required: true
          description: ISO country code (alpha-2).
          schema:
            type: string
            pattern: "^[A-Za-z]{2}$"
            example: us
        - name: year
          in: path
          required: true
          description: Calendar year of the data.
          schema:
            type: integer
            example: 2025
      responses:
        "200":
          description: OK
          headers:
            ETag:
              description: Entity tag for caching.
              schema: { type: string }
            Cache-Control:
              description: Cache hints from CDN.
              schema: { type: string }
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Rates"
        "404":
          description: Not Found

  /data/{code}/index.json:
    get:
      tags: [Country]
      summary: Get list of available years for a country
      parameters:
        - name: code
          in: path
          required: true
          description: ISO country code (alpha-2).
          schema:
            type: string
            pattern: "^[A-Za-z]{2}$"
            example: us
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CountryYears"
        "404":
          description: Not Found

  /data/index.json:
    get:
      tags: [Country]
      summary: Get list of available countries by years
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CountriesYears"
        "404":
          description: Not Found

  /data/world/index.json:
    get:
      tags: [World]
      summary: Get list of available years (world)
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WorldYears"
        "404":
          description: Not Found

  /data/world/{year}/data.json:
    get:
      tags: [World]
      summary: Get full countries data by year
      parameters:
        - name: year
          in: path
          required: true
          description: Calendar year of the data.
          schema:
            type: integer
            example: 2025
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WorldData"
        "404":
          description: Not Found

  /data/world/{year}/rates.json:
    get:
      tags: [World]
      summary: Get world rates by year
      parameters:
        - name: year
          in: path
          required: true
          description: Calendar year of the data.
          schema:
            type: integer
            example: 2025
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Rates"
        "404":
          description: Not Found

components:
  schemas:
    Rank:
      type: integer
      enum: [1, 2, 3, 4, 5]

    PartyRangeCounts:
      type: object
      additionalProperties: false
      properties:
        "1": { type: integer, minimum: 0 }
        "2": { type: integer, minimum: 0 }
        "3": { type: integer, minimum: 0 }
        "4": { type: integer, minimum: 0 }
        "5": { type: integer, minimum: 0 }
      required: ["1", "2", "3", "4", "5"]

    PartyRangeStats:
      type: object
      description: Popularity of party political ranges (1=left to 5=right) among officials with a mapped party.
      additionalProperties: false
      properties:
        counts:
          $ref: "#/components/schemas/PartyRangeCounts"
        mostPopularRanges:
          type: array
          items: { $ref: "#/components/schemas/Rank" }
          uniqueItems: true
        mostPopularCount:
          type: integer
          minimum: 0
        totalCountedOfficials:
          type: integer
          minimum: 0
          description: Officials that contributed to the 1..5 tally.
        unaffiliatedCount:
          type: integer
          minimum: 0
        unmappedPartyCount:
          type: integer
          minimum: 0
      required:
        - counts
        - mostPopularRanges
        - mostPopularCount
        - totalCountedOfficials
        - unaffiliatedCount
        - unmappedPartyCount

    PartyRangeSplitStats:
      type: object
      description: Party-range popularity split into executive vs the rest (ministers, senate, deputies, officials).
      additionalProperties: false
      properties:
        executive:
          $ref: "#/components/schemas/PartyRangeStats"
        rest:
          $ref: "#/components/schemas/PartyRangeStats"
      required: [executive, rest]
      example:
        executive:
          counts: { "1": 1, "2": 4, "3": 2, "4": 0, "5": 0 }
          mostPopularRanges: [2]
          mostPopularCount: 4
          totalCountedOfficials: 7
          unaffiliatedCount: 0
          unmappedPartyCount: 1
        rest:
          counts: { "1": 3, "2": 12, "3": 7, "4": 2, "5": 0 }
          mostPopularRanges: [2]
          mostPopularCount: 12
          totalCountedOfficials: 24
          unaffiliatedCount: 2
          unmappedPartyCount: 3

    MinistersBlock:
      type: object
      additionalProperties: false
      properties:
        quantity:
          type: integer
          minimum: 0
          description: Number of ministers.
        budget:
          type: number
          minimum: 0
          description: Annual ministerial budget converted to USD.
      required: [quantity, budget]

    ChamberBlock:
      type: object
      additionalProperties: false
      properties:
        quantity:
          type: integer
          minimum: 0
          description: Number of seats.
      required: [quantity]

    Salary:
      type: object
      additionalProperties: false
      properties:
        gross:
          type: number
          description: Gross annual salary (same currency as net).
        net:
          type: number
          description: Net annual salary.

    Source:
      type: object
      description: Single source entry with exactly one label → value mapping.
      minProperties: 1
      maxProperties: 1
      additionalProperties:
        anyOf:
          - type: number
          - type: string
          - type: string
            format: uri
      example:
        pdf: https://example.com/file.pdf

    Sources:
      type: array
      items: { $ref: "#/components/schemas/Source" }
      example:
        - pdf: https://example.com/salary.pdf
        - bonus: 1200
        - notes: "Declared report"

    Official:
      type: object
      additionalProperties: false
      properties:
        name: { type: string }
        gender:
          type: string
          enum: [M, F, X]
        role: { type: string }
        budget:
          type: number
          description: Annual ministerial budget.
        district:
          type: string
          description: Localized/common district name.
        party:
          type: string
          description: Optional party code; refers to an entry in `CountryData.parties`.
        salary:
          $ref: "#/components/schemas/Salary"
        sources:
          $ref: "#/components/schemas/Sources"
      required: [name]

    Parties:
      type: object
      description: Map of party code → metadata.
      additionalProperties:
        $ref: "#/components/schemas/Party"
      example:
        SPD:
          name: Sozialdemokratische Partei
          en: Social Democratic Party
          range: 2
          color: "#FF0000"
        CDU:
          name: Christlich Demokratische Union
          en: Christian Democratic Union
          range: 4
          color: "#000000"

    Party:
      type: object
      additionalProperties: false
      required: [name, range, color]
      properties:
        name:
          type: string
          description: Localized/common name.
        en:
          type: string
          description: English display name.
        range:
          $ref: "#/components/schemas/Rank"
          description: Political wing level (1 → 5). 1 is the most left, 5 is the most right.
        color:
          type: string
          description: Hex color code.
          pattern: "^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$"

    CountryData:
      type: object
      additionalProperties: false
      required: [baseCurrency]
      properties:
        baseCurrency:
          type: string
          description: ISO 4217 currency code for salary figures.
          example: USD
        royalty:
          type: array
          items: { $ref: "#/components/schemas/Official" }
        executive:
          type: array
          items: { $ref: "#/components/schemas/Official" }
        ministers:
          type: array
          items: { $ref: "#/components/schemas/Official" }
        deputies:
          type: array
          items: { $ref: "#/components/schemas/Official" }
        senate:
          type: array
          items: { $ref: "#/components/schemas/Official" }
        officials:
          type: array
          items: { $ref: "#/components/schemas/Official" }
        parties:
          $ref: "#/components/schemas/Parties"

    Rates:
      type: object
      description: Snapshot of currency exchange rates and macro figures for the base currency.
      additionalProperties: false
      properties:
        baseCurrency:
          type: string
          description: ISO 4217 code or ticker symbol of the base currency (e.g., USD, EUR, BTC).
          pattern: "^[A-Z0-9]{3,5}$"
        GDP:
          type: number
          description: Nominal GDP (last full year) for the base economy.
        GDPPerCapita:
          type: number
          description: Nominal GDP per capita (last full year).
        minAnnualSalary:
          type: number
          description: Nominal gross minimum annual salary amount in the base currency's economy.
          minimum: 0
        timestamp:
          type: string
          format: date-time
          description: ISO 8601 timestamp when the snapshot was recorded.
        rates:
          type: object
          description: Mapping of target currency code to its exchange rate per 1 unit of the base currency.
          additionalProperties: false
          patternProperties:
            "^[A-Z0-9]{3,5}$":
              type: number
              description: Units of the target currency per 1 base currency unit.
      required: [baseCurrency, timestamp, rates]
      example:
        baseCurrency: USD
        GDP: 1370000000000
        GDPPerCapita: 28562
        minAnnualSalary: 15000
        timestamp: "2025-07-31T00:00:00Z"
        rates:
          AUD: 1.51
          BRL: 5.2
          BTC: 0.000016
          CAD: 1.34
          CHF: 0.89
          CNY: 7.25
          ETH: 0.00025
          EUR: 0.91
          GBP: 0.78
          INR: 83.1
          JPY: 140.32
          KRW: 1300.5
          MXN: 17.1
          RUB: 80.0
          ZAR: 18.4

    CountryStats:
      type: object
      additionalProperties: false
      properties:
        GDP:
          type: number
          description: Nominal GDP converted to USD (per builder output).
          minimum: 0
        GDPPerCapita:
          type: number
          description: Nominal GDP per capita converted to USD.
          minimum: 0
        GDPGrowthYoY:
          type: number
          nullable: true
          description: Year-over-year growth of GDP (percent).
        GDPPerCapitaGrowthYoY:
          type: number
          nullable: true
          description: Year-over-year growth of GDP per capita (percent).
        minAnnualSalary:
          type: number
          description: Minimum annual salary converted to USD.
          minimum: 0
        minAnnualSalaryGrowthYoY:
          type: number
          nullable: true
          description: Year-over-year growth of minimum annual salary (percent).
        ministersBudgetPctOfGDP:
          type: number
          nullable: true
          description: Ministerial budget as a percentage of GDP.
        ministers:
          $ref: "#/components/schemas/MinistersBlock"
        deputies:
          $ref: "#/components/schemas/ChamberBlock"
        senate:
          $ref: "#/components/schemas/ChamberBlock"
        partyRangeStats:
          $ref: "#/components/schemas/PartyRangeStats"
        partyRangeStatsSplit:
          $ref: "#/components/schemas/PartyRangeSplitStats"
      required: [GDP, GDPPerCapita, ministers, deputies, senate]

    CountriesYears:
      type: object
      additionalProperties:
        type: array
        items:
          type: integer
          example: 2025
      example:
        ar: [2025]
        es: [2025]
        fr: [2025]
        us: [2025]

    CountryYears:
      type: array
      description: List of available years with data, sorted in descending order
      items:
        type: integer
        example: 2025
      minItems: 1
      uniqueItems: true
      example: [2025, 2024, 2023]

    WorldData:
      type: object
      description: Country-indexed snapshot of macro and government composition data.
      propertyNames:
        type: string
        pattern: "^[a-z]{2}$"
      additionalProperties:
        $ref: "#/components/schemas/CountryStats"
      example:
        ar:
          GDP: 633270000000
          GDPPerCapita: 14235
          GDPGrowthYoY: 1.8
          GDPPerCapitaGrowthYoY: 0.9
          minAnnualSalary: 15000
          minAnnualSalaryGrowthYoY: 2.1
          ministersBudgetPctOfGDP: 0.85
          ministers: { quantity: 7, budget: 22561000000 }
          deputies: { quantity: 257 }
          senate: { quantity: 72 }
          partyRangeStatsSplit:
            executive:
              counts: { "1": 0, "2": 4, "3": 1, "4": 0, "5": 0 }
              mostPopularRanges: [2]
              mostPopularCount: 4
              totalCountedOfficials: 5
              unaffiliatedCount: 0
              unmappedPartyCount: 0
            rest:
              counts: { "1": 3, "2": 8, "3": 6, "4": 9, "5": 4 }
              mostPopularRanges: [4]
              mostPopularCount: 9
              totalCountedOfficials: 30
              unaffiliatedCount: 6
              unmappedPartyCount: 2
        es:
          GDP: 1749040659341
          GDPPerCapita: 37121
          GDPGrowthYoY: 2.2
          GDPPerCapitaGrowthYoY: 1.0
          minAnnualSalary: 22000
          minAnnualSalaryGrowthYoY: 3.5
          ministersBudgetPctOfGDP: 1.12
          ministers: { quantity: 22, budget: 190880197802 }
          deputies: { quantity: 348 }
          senate: { quantity: 265 }
          partyRangeStats:
            counts: { "1": 5, "2": 9, "3": 11, "4": 6, "5": 3 }
            mostPopularRanges: [3]
            mostPopularCount: 11
            totalCountedOfficials: 34
            unaffiliatedCount: 8
            unmappedPartyCount: 1

    WorldYears:
      type: array
      description: List of available years with data, sorted in descending order
      items:
        type: integer
        example: 2025
      minItems: 1
      uniqueItems: true
      example: [2025, 2024, 2023]
